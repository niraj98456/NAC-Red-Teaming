NAC RED TEAMING
Red Teaming in Network Access Control (NAC) is pretending to be real-life hackers who try to get around NAC systems to get into an organization's internal network without permission. These tests are mostly on the first step of a cyberattack, which is getting in. The Red Teaming look at typical NAC enforcement methods like IEEE 802.1X, MAC Authentication Bypass (MAB), and Web Authentication (WebAuth). Network defence evaluation focusses on network security against external threats. Firewalls function to protect LANs from hackers, worms, spammers, and other internet threats. External threats are a major security issue faced by networks, but the growth of mobile computing and the proliferation of Ethernet-enabled devices have made LAN-based attacks surpass external threats. Employees can bring malware from equipment outside the network. Visitors and contractors can bring malware to plan crimes that cause network disruptions. Allied Telesis switches provide a sufficiently comprehensive defence access to counter internal attacks such as data theft, address resolution protocol (ARP) spoofing, and DOS attacks (Duggan & Wood, 1999).  NAC is one of the network security solutions that allows administrators to automate policy enforcement. NAC determines network policies on a centralised server and requires every network user to implement those policies (Allied Telesis, 2025). 
	Red Teaming tests the effectiveness of cybersecurity where ethical hackers conduct simulated cyber attacks to identify system vulnerabilities. Red teaming helps organisations uncover, understand, and also mitigate organisational security risks from exploiting cyber threats. The proactive red teaming approach enables security teams to protect sensitive data (Anderson, 2024). The presence of red teaming in bypassing NAC serves to test the proactivity of the defensive blue teaming. This helps the blue team to develop new security strategies in TTP cybersecurity. Red Teaming bypassing NAC conducted by red teamers allows the company to enhance network security protocols. Red teaming that conducts attacks by breaching network security controls to gain network access, steal sensitive information, and disrupt operations to determine potential security actions and identify vulnerabilities that need to be addressed (Kotwani,2024).
	The bypass conducted by the red team against the NAC to gain unauthorised access to the internal network, and if the red teamer finds a gap in exploiting the network, then the NAC control system is weak. Red Teaming attacks that mimic legitimate and authorised devices demonstrate how networks protected by NAC can still be exploited by attackers who appear to be trusted devices and users. The red teaming attack serves to evaluate the blue teaming's defences in responding to the bypass attempts made by the red teaming. If the bypass conducted by the Red Teaming is not recognised by the NAC and blue teaming, then the security of the blue teaming and NAC has a critical gap in responding to threats to network security. Red Teaming analyses the NAC policy through the authorisation of unknown devices entering the VLAN as guests via MAC addresses, so this weakness can become an opportunity for Red Teaming to exploit the network (Stolfo, Kereomytis, & Frias, 2009). 
1.3.1 NAC & Red Teaming Workflow
1.3.1 Reconnaissance & Fingerprinting
One important aspect and the first stage in a cyber-attack is reconnaissance. In the reconnaissance phase, there are three stages that must be carried out by the red team, namely casing, scanning, and enumeration. Casing, where the attacker uses a web browser to dig up available information. Scanning, where the attacker uses specialised tools to identify active hosts to find information about ports on the host. 






















                        
Fig. 18 : NAC Bypass Methods

where the attacker uses special tools to attack the target (Beecroft, 2009). Reconnaissance and fingerprinting are conducted by red teaming to under-stand how NAC works on the network targeted by red teaming. Red Teaming bypass NAC requires several actions such as passive sniffing by observing network traffic with reconnaissance and attacks to avoid security detection. Passive sniffing uses SPAN ports on switches, network hubs, and guest VLANs to detect open networks to understand how NAC works.

1.3.2  802.1X (EAPoL) Traffic
802.1X functions to limit traffic on the port by using a single-host mode where only devices can cross the endpoint of the 802.1X port. Red Teaming uses traffic to gather important information about NAC through EAPoL to identify EAP/EAP-TLS/PEAP methods. ARP traffic helps red teaming identify how NAC reacts to new devices connecting to the network. DHCP traffic is used by NAC for device finger-printing by examining DHCP option 55 (parameter request list) and option 60 (vendor class identifier). CDP/LLDP provides information to NAC regarding devices accessing the network, enabling NAC to perform port-based profiling.  By analysing network traffic, red teaming identifies the NAC used by the network, whether it is 802.1X, MAC Authentication Bypass, or Web Authentication. This information is important for red teaming to determine bypass techniques to exploit weak fallback policies.  At the reconnaissance & fingerprinting stage, there are several tools that can be used by red teamers, such as tcpdump to analyse EAPoL, DHCP, ARP, and CDP network traffic. Then bettercap for sniffing, spoofing, and profiling devices. Responder to mimic network service servers. Eaphammer to attack 802.1X, especially in performing EAP relay and credential harvesting (Parhi, 2012).
Device Profiling is a method used to collect information related to devices through remote computing. The device profiling and cloning techniques used by red teaming mimic legitimate devices that have been authorized by NAC to access the network. Device profiling accesses the network using the MAC address, DHCP requests, and layer 2 protocol traffic. If red teaming spoofs the MAC address, the NAC system will automatically grant the attacker access to the system network. Besides MAC spoofing the technique that can be employed by attackers is DHCP spoofing, where DHCP option 55 and option 60 can help attackers determine the NAC system used by the network. DHCP requests that modify devices appear as authenticated NAC devices can cause unauthorized devices to be classified by NAC as legitimate devices-es. Then the attacker can also spoof the protocol using the LLDP/CDP scenario where the protocol is used by network switches to identify devices and users connected to the network. The LLDP method helps the red team to obtain information such as hostname and devices connected that are recognised by NAC. The LLDP method used by the attacker to impersonate or even change the user's MAC address to convince the NAC to grant access to the network (Musa Muhammed, 2019). 

1.3.3 Initial Access Payload Deployment
	At the stage of initial access payload deployment where the red team successfully bypasses the NAC system, the payload will establish control over the target network. The NAC bypass performed by the red team will connect unauthorised devices to the internal network by mimicking and duplicating trusted devices. The goal of delivering the initial access payload is to establish a persistent foothold in the network targeted by the attacker. The delivery of the payload carried out by the red team to simulate post-compromise scenarios with data theft, lateral movement, and escalation of network access rights (Santos, 2023).
	In conducting the initial access payload deployment, there are several methods that can be employed by the red team, namely: Command and Control C2 beacon. The C2 beacon controlled by the red team can execute code, collect information, and download important files from the system. In conducting control (C2) beacon, there are several important tools that support the red team, such as Sliver and Cobalt Strike. These tools can generate payloads through encrypted protocols like HTTPS, allowing the beacon to provide remote access and compromise the host without direct physical access. Besides the Initial Access Payload Deployment method, there is a stager payload to reduce the risk of malware detection sent by red teaming. The stager is sent by the attacker through PowerShell scripts, binary droppers, and also through malicious documents that can be downloaded by the target. The stager can provide the attacker with access to control the system remotely and perform keylogging, system enumeration, and privilege escalation (Nouf Aljammaz & Alenezi, 2025).
	After planting the payload, the red team pivoted to other subnets to connect with other targets. The NAC system connects devices to other devices such as printers, phones, and laptops into a VLAN. Routing between subnets allows the red team to use other devices to compromise the targeted device. Internal reconciliation tools enable red teaming to perform port forwarding, credential theft, and lateral movement to more sensitive networks. This indicates that the NAC bypass performed by red teaming can enhance domain compromise not only by gaining network access but also by controlling the entire system (CiscoSystems, 2006).

1.3.4 Command & Control (C2)	
	Red teaming that successfully bypasses the NAC system by gaining access to the internal network can establish a covert communication channel within the system controlled by the attacker. The purpose of command & control is for the attack-er to remotely control devices without being detected by the network defence system and to execute commands and extract data from the system. The techniques used by attackers in command & control are DNS Tunnelling, HTTPS Beaconing, and ICMP Exfiltration. DNS Tunnelling is a C2 communication method that functions to hide data traffic in DNS requests and responses. The DNS Tunnelling method is one of the most effective methods for bypassing firewalls and proxies. DNS tunnelling inserts data and commands into DNS server queries that contain further instructions (Cartier, 2021).
	HTTPS beaconing is a command & control technique used by attackers through an encrypted HTTPS connection, disguising themselves as regular web traffic. HTTPS beaconing looks like regular web traffic and can be accessed publicly, making it difficult to distinguish between fake websites and genuine service websites.
	ICMP Exfiltration where a system with very strict surveillance makes red teaming use the ICMP protocol with the "ping" command for covert communication and data smuggling from the accessed system. Actually, the "ping" command can be considered a harmless command by network security systems, making ICMP exfiltration one of the ideal communication channels to determine whether the target device's services are active or not. after the NAC bypass carried out by red teaming by mimicking legitimate devices and exploiting fallback VLAN, Red teaming needs to communicate using command & control to avoid suspicion (Wheeler & Larsen , 2023).

1.4 NAC Bypass Techniques 
The NAC system uses access policies based on device security, device and user compliance with the organization, and user identity. NAC uses the 801.1X, MAB, and Web Authentication protocols to determine which devices can access the network VLAN. NAC Bypass by red teaming to mimic attackers in exploiting the network to conclude whether NAC is effective for network security through spoofing, impersonation, and exploitation of NAC policies (Ibid).

1.4.1 MAC Spoofing
MAC Spoofing is one of the techniques used to change the MAC address to resemble the MAC address of legitimate devices accessing the network. The MAC address is used as one of the unique identifiers in the network. MAC spoofing is used by attackers to impersonate trusted devices. Red Teaming performs MAC Spoofing to bypass NAC security controls that rely on MAC addresses to verify devices connected to the network. Each NIC has a different MAC address, but in the modern era, attackers can also change the MAC address using software. The MAC spoofing attack allows at-tackers to monitor network traffic through devices that have gained access via the MAC address. The attacker changes the MAC address to a valid MAC address that exists in the network system, which can deceive the NAC system into granting de-vice access if the system reads that the endpoint is legitimate. The NAC system grants access to devices to enter the network if the MAC address is on the system's whitelist. In performing NAC bypass, the Red Team attempts to carry out MAC spoofing to gain access that is considered legitimate by NAC without requiring valid credentials. The offensive attacker scenario conducted by the red team uses several tools for MAC spoofing such as mac-changer on Linux, netsh on Windows, and macOS (ifconfig). After finding the appropriate MAC address, the attacker clones the MAC address to request access to the network.

Rogue DHCP / DNS Server
	Rogue DHCP and DNS attacks are carried out by attackers to infiltrate the network server unlawfully. The server attack provides malicious configurations to client devices, including incorrect IP addresses, fake gateways, DNS manipulation, and incorrect routing information (Gillis, 2025). The Rogue DHCP attack tactics carried out by Red Teaming intercept network communications, especially at endpoints protected by NAC. 
The DHCP server becomes one of the parameters for attackers to measure the state of the network, such as IP addresses, subnet masks, default gateways, and DNS server addresses. A fake DHCP attack mimics a rogue DHCP server within the network, causing the server to respond to the rogue DHCP server officially. This technique is used by Red Teaming to redirect network traffic, capture credentials, and perform lateral movement within the network without the knowledge of NAC.

1.4.2 switch port stealing
	Switch port stealing is one of the techniques to exploit vulnerabilities in network switches in NAC defense. This attack floods the switch's MAC addresses with fake addresses, which can fill up the server, after the legitimate MAC-to-port association is disrupted, the attacker impersonates a trusted device in the network server. The switch that stores the content addressable memory (CAM) table functions to map MAC addresses, assisted by the switch, to forward traffic to the destination port according to the segmentation of network traffic. In a Switch port stealing attack, which is flooded with fake MAC addresses, the switch is forced into a "fail open" condition, broadcasting all traffic to all ports, thereby causing isolation between devices in the network. The NAC system relies on the relationship between switch ports and authenticated devices, so if an attacker overloads the switch CAM with fake MAC addresses, the NAC cannot allocate MAC addresses correctly. This causes unauthorized network access to lead NAC to mistakenly allow unauthorized devices to bypass NAC policies (Farooq, 2025). 

1.4.3  802.1X Bypass
	802.1X is one of the NAC protocols used in both wired and wireless networks to enforce security policies. The protocol authenticates devices requesting access to the network through an authenticator that forwards the authentication request to the RADIUS server. The authentication process uses EAPOL frames, so attackers use supplicant impersonation to mimic the behavior of legitimate devices in the 802.1X network to capture valid EAPOL messages and replay them on the attacking device. Attackers who perform supplicant impersonation deceive the authenticator into believing that the device connected to the network is a legitimate device to avoid NAC enforcement (Parhi, 2012). 

1.4.4 Man in the Middle (MitM)
Man in the Middle is one of the attack techniques used to eavesdrop and modify communication between both parties without the victim's knowledge. MitM attacks target the network authentication process where the attacker gains network access by positioning themselves as a legitimate client to observe, intercept, and relay authentication messages to gain network access (Gregg & Kosinski, 2025). NAC policies require devices to pass an authentication process before accessing the network through 802.1X, web portals, and MAC-based authentication. Red teaming that uses NAC bypass through Man-in-the-Middle (MitM) attack methods involves real-time authentication relaying, and if the attacker forwards the authentication request to the authentication server network, the attacker will act as a transparent proxy.

1.4.5 Realistic Adversary Simulation
	Realistic Adversary Simulation is an offensive cybersecurity method focusing on behavior, techniques, and attack tactics. This technique measures the system's defense vulnerabilities, the defense response to incidents, and the detection mechanisms of scenarios resembling real attacks. Realistic Adversary is used to bridge and evaluate the security of the organization by testing defense perimeters, internal controls, and the ability to detect threats. The Realistic Adversary Simulation technique is used in NAC to verify the system's security level in responding to ransomware and attacks that potentially threaten network security. Red teaming uses the Realistic Adversary Simulation method to test 802.1X by cloning MAC addresses, VLAN separation, and also hijacking device sessions within the network. This is done to test the security of NAC by attacking the network with the aim of bypassing the layered access control of NAC policies.

1.4.6 MAC Filtering
	MAC Filtering is one of the important mechanisms of NAC security, which authenticates devices before they gain access to the network. MAC filtering grants or denies access to devices based on their MAC address, which serves as an identifier for the computer or device. MAC filtering is used on 802.1X, especially on devices, printers, and IoT endpoints. The NAC policy mechanism uses a MAC filtering system with several modes such as static whitelisting, dynamic profiling, and sticky MAC. Static whitelisting where the admin maps trusted MAC addresses within the system. Dynamic profiling where NAC requests DHCP to register devices in the system's whitelist, while sticky MAC where NAC allocates MAC addresses according to the list in the system's whitelist. The NAC policy restricts unauthorized devices from accessing the network. However, the NAC policy system still has vulnerabilities in the implementation of security policies. Red teaming can bypass MAC filtering through MAC spoofing by mimicking the same MAC address as legitimate devices using MAC spoofing techniques with Macchanger, VLAN hopping, and bypassing sticky MAC (CISCO, 2011).
	MAC spoofing with the Macchanger tool is used by attackers to change the device's MAC address to resemble a legitimate MAC address on the NAC network system. VLAN hopping is performed after MAC spoofing, where the attacker switches from the pre-authentication VLAN to the production VLAN. Then, by bypassing sticky MAC, the attacker de-authenticates the original device to spoof the MAC address and take over the device's authorization on the network.

1.4.1 MAC IP binding
	MAB IP Binding is an important NAC mechanism to ensure the consistency of the MAC device with the IP address during the connection session. MAC IP Binding is designed to prevent unauthorized devices from spoofing with MAC and IP addresses obtained illegally, which could potentially disrupt the network connection. Layer 2 (MAC) and layer 3 (IP) attributes in the NAC system enforce access control over who is entitled to access the network. Cisco ISE, FortiNAC, and Aruba ClearPass use DHCP snooping techniques and IP-MAC correlation to enforce IP-MAC policies. The IP-MAC policy monitors network traffic through MAC addresses listed in the system's whitelist. Additionally, the NAC enforcement point (switch/controller) stores cached information to perform session integrity validation.
The main objective of enforcement is to check the consistency of the MAC address based on DHCP. When a device requests an IP address through DHCP, the NAC system will record the DHCP handshake process, including the MAC address, lease, and DHCP options (hostname). If there is an IP address that does not match the MAC address in the system's whitelist, then the NAC will take remediation actions, de-authentication, and re-profiling on that endpoint. In network security defense, MAP-IP Binding is quite useful for network security; however, despite its usefulness, MAP-IP Binding is still vulnerable to attacks because the security of MAC-IP Binding relies on passive DHCP snooping and static correlation used, al-lowing attackers to spoof DHCP traffic to bypass NAC. 
In a realistic adversary simulation, IP spoofing is used as one of the basic strategies to bypass MAC-IP Binding because attackers configure devices to use fake IPs that resemble the MAC addresses of devices authorized to access the network. In addition to the IP Spoofing attack method, attackers also use DHCP option cloning to bypass NAC policies through DHCP fingerprinting. Attackers perform DHCP option cloning using tools like [scapy] to create DHCP discover packets that closely resemble the DHCP fingerprint of legitimate devices. ACK spoofing with scapy, by spoofing DHCP ACK, is also one of the attack techniques used by attackers to send engineered DHCP requests to simulate the DHCP handshake on the NAC system to bypass NAC. 
1.4.8 Device Profiling
Device profiling performs MAC/IP authentication on the NAC system to identify devices, operating systems, and endpoints through active and passive techniques that enable the implementation of NAC policies to clarify the MAC or IP addresses of devices according to the devices that have network authority. NAC uses device profiling to identify devices that will connect to the network. In profiling input, the NAC policy uses LLDP, DHCP, SNMP, NetFlow, and OS Fingerprint. Where the Link Layer Discovery Protocol provides information about switch ports and system capacity, while the DHCP option gives clues related to the device's operating system. SNMP provides detailed information regarding sysDescr and interface type. NetFlow provides device data such as port, volume, and destination patterns. Then, OS fingerprinting provides final confirmation to the NAC. After the NAC identifies the device requesting access to the network, the NAC will implement the policy enforcement layer system using the device profile to determine the VLAN and ACL.
No matter how advanced the profiling-based enforcement is, red teaming is able to bypass the device profiling conducted by NAC. This happens because device profiling relies on unencrypted data (LLDP / DHCP), therefore, attackers can spoof information that is exactly the same as the encrypted devices on the NAC whitelist. On the other hand, NAC usually experiences re-profiling failures when the initial device profile that has been granted network access requests network access again, allowing the cloned device by the attacker to easily obtain network traffic. The method used by the attacker to bypass Device Profiling is by cloning the LLDP/DHCP/OS fingerprint from the device that has legitimate network access. Red teaming uses reconnaissance methods by capturing LLDP packets, DHCP options, and SPAN port access using tools like [tcpdump and wireshark].
Then the attacker can also use LLDP cloning with lldpad. LLDP stores important information for the attacker such as system name, software version, port ID, and the switch connected to the NAC. Lldpad helps the attacker send the cloned LLDP packets to the NAC so that the switch port does not detect the unauthenticated device. The attacker also performs DHCP fingerprint spoofing through dhclient to profile devices such as option 55, vendor class, and hostname. The use of [dhclient] also clones devices that exactly match the profile of legitimate devices, so the DHCP spoofed packets sent by the attacker can make the NAC endpoint recognize the pro-file and grant the device access to the network. In addition to using LLDP/DHCP/OS fingerprint cloning via lldpad, dhclient, red teaming also uses fingerprinting via NMAP passively by grouping TCP/IP such as window size, TTL, TCP options to spoof fingerprints by modifying kernel parameters (sysctl) using [Nmap] tools to perform OS fingerprint spoofing mode.

1.4.9 User Certificate (EAP-TLS)
User Certificate (EAP-TLS) is an 802.1x authentication mechanism used in NAC security enforcement, which employs a certificate mechanism on the server to establish mutual trust in accessing the network. The certification system is used by NAC with the Zero Trust principle to ensure that only authenticated users or devices can access the network. NAC policies, primarily on the Aruba ClearPass, Cisco ISE, and Microsoft NPS platforms, only allow x.509 certified endpoints to access the network. The x.509 certificate is installed by the device user as the device identity, which will be verified by NAC to ensure revocation status, chain of trust, and subject attributes (CN, OU, SAN) to gain network access. The way EAP-TLS works is by requesting access through a switch confirmed by 802.1X via RADIUS, which requests the user's certificate to negotiate a secure TLS session. If authentication is successful, the client will gain access to the network.
Although the enforcement of User Certificate (EAP-TLS) can filter users who can be granted access to the network, if an attacker gains access to the certificate, they can impersonate a legitimate client certificate and use it. The certificates stored in software keystores and smart cards can be exploited by insiders, malware, and disk image analysis, leading to weak endpoint configurations. Red teaming uses certificate and user private key exfiltration attacks to conduct phishing, credential theft, malware, and physical access to disk images. The attacker exports the certificate using [Certutil, Mimikatz] to extract the .pfx file. Then, the file is converted for use in a fake authentication session, allowing the attacker to impersonate a legitimate device. Additionally, the attacker can also use OpenSSL to perform conversion and validation of the certificate. OpenSSL is used to verify certificates, expiration dates, and other attributes needed by attackers to create fake certificates. The attacker also uses wpa_supplicant to authenticate 802.X by configuring wpa_supplicant.conf to request access through ports protected by 802.1X, and if the certificate is still valid, the NAC will not fingerprint the attacker requesting access, so the attacker remains undetected by the NAC system.

1.4.10 Device Certificate
NAC uses device certificates for authentication to adopt a machine-based trust model. Device certificates are directly bound to the endpoint and are used to ensure that only devices compliant with NAC policies can access the corporate network. NAC that uses 802.1X and EAP-TLS certificates allows endpoints to authenticate at boot time for login. Device certificates issued by the internal Certificate Authority are validated by NAC as part of the certificate chain and attributes to gain access to the network. The company stores the device certificate on the Trusted Platform Module (TPM) protected by a strong and hard-to-detect password. However, a misconfigured TPM can place the device certificate in the wrong location, making the storage of the device certificate easy to exploit. Attackers can bypass TPM enforcement by targeting software affiliated with TPM, such as CSP. Attackers can use direct memory access (DMA) techniques. BIOS-level attacks and exploitation of virtualization sandboxes to access device certificates.
After gaining SYSTEM access obtained from the cloned device, the attacker uses the [certipy] tool to exploit the Active Certificate Service (ADCS) to enumerate, request, and export device certificates. Certipy mimics the identity of a legitimate device to interact with ADCS to request the device certificate, then, the at-tacker who successfully extracts the certificate through certipy can also use [wpa_supplicant] to mimic EAP-TLS authentication to set up the wpa_supplicant.conf file. conf contains certificates, CA chains, and keys so that the attacker can impersonate a legitimate device. If NAC does not check additional telemetry.
such as MAC/IP cache or perform OS fingerprinting, the attacker will easily gain secure access to the VLAN without being detected by NAC.


Fig. 19: Realistic Adversary Simulation
1.4.11 Compliance/Posture Agent
Posture-based NAC enforcement validates the security, compliance, and health conditions of endpoints before granting access to network resources. Enforcement assesses the characteristics of the device through patching levels, antivirus status, firewall, and disk encryption. If the device does not meet the criteria set by NAC, the device will be directed to the quarantine VLAN. The local agent functions to collect data in the system to evaluate devices according to the configured policies. The local agent provides reports related to device security, and from these local agent reports, the NAC can act to grant full access to devices in the quarantine VLAN or assign them to a limited VLAN by executing remediation scripts.
There are two agents used by NAC, namely Cisco ISE Posture Agent and Aruba ClearPass OnGuard. Cisco ISE uses AnyConnect Secure Mobility Client to check the OS version, assess the registry, and the status of security software. Meanwhile, Aruba ClearPass OnGuard supports a permanent agent that can be dissolved by evaluating the condition of Windows/Mac systems, AD domain membership, and the presence of applications on the device. After sending the status to the NAC serv-er, the NAC will evaluate the compliance with the administrator's policies.
Although NAC has an effective Compliance / posture agent enforcement policy for network security, attackers can target NAC's posture enforcement by faking the compliance status of devices from endpoints through reverse engineering the workings of the posture agent, where attackers can develop a fake "compliant" script. If attackers succeed in creating a fake script and NAC receives a false report granting access, the posture enforcement can be easily bypassed by the attackers. An attacker who can access the posture validation token on the NAC server through a man-in-the-middle attack and memory scraping techniques on the com-promised device can reuse the token obtained from another device to gain access to the NAC. NAC posture with formal XML/JSON, if the endpoint communication is weak, the attacker can intercept and modify the content of the posture report. For example, if [antivirus:inactive] is modified by the attacker to [antivirus:active], the false report will be accepted by NAC without rechecking, allowing non-compliant devices to access the network. In addition to the XML/JSON manipulation bypass technique, there is the dissolvable agent bypass technique where an attacker can analyze the binary of the dissolvable agent through reverse engineering, creating a fake binary script that produces a compliant scan.

1.4.12 Captive Portals
Captive portal is one of the web-based NAC access control methods that intervenes in network traffic and directs users to an authentication page before the device gains full access to the network. NAC places endpoints in a restricted VLAN or pre-auth VLAN on devices connected to the network. HTTP/HTTPS requests from endpoints are redirected to the captive portal server to complete the login process. Once successful, NAC will move the device to the production VLAN to gain network access according to NAC policies.
NAC uses Cisco ISE and Aruba ClearPass on the captive portal for self-service device registration using the device's MAC address, browser posture check through a JavaScript endpoint, user authentication using LDAP, RADIUS, and SAML login, and Acceptance of AUP where all users must agree to NAC's terms and conditions before accessing the network. The captive portal that relies on data input from the browser means that security also heavily depends on the validation and tokenization applied. If validation relies on regular HTML form data, then attackers will easily be able to mimic and automate interactions without validating legitimate users.
Users who have completed the captive portal process will then be issued a session token by NAC to prove that the device has been validated by NAC. If an attacker can intercept the token through sniffing, XSS, and access to the victim's device, the token can be reused to avoid re-login. Attackers can use a [rogue captive portal] by mimicking the original appearance. The MITM scenario directs the victim to a fake portal to obtain the target's credentials and device fingerprint. If the attacker successfully obtains the device fingerprint, the attacker can access the network from their own device using information from the victim's device.
The NAC bypass carried out by the attacker through MAC spoofing, where users who have completed the portal process and gained network access according to the MAC address, allows the attacker who knows the user's MAC address to register and perform MAC spoofing to avoid the captive portal. Additionally, there is a method to bypass NAC using tactics such as [Rogue Client and Portal Emulation] where the attacker can scan the network by identifying redirects to the captive portal, analyze the HTML structure of the portal, then provide an auto-login script for fake validation. If the attacker obtains a token from the server, they can replay it through another device. The attacker uses a rogue portal to obtain the target's credentials, and once the MAC address is obtained by the attacker, they can access the production VLAN.

1.4.13 Dynamic VLAN Assignment
	Dynamic VLAN Assignment is a key feature of NAC for segmenting network access based on device status. NAC assigns VLANs to endpoints after verifying the identity and compliance of the devices. When a device connects to the network through a switch port with MAC Authentication Bypass, the request will be sent to VLAN assignment. After NAC verifies the device, RADIUS will include the Tunnel Private Group ID attribute, and then the switch will assign the port to the VLAN.
	NAC bypass carried out by Red Teaming through [monitoring EAP Success] where the attacker intercepts the layer 2 domain to monitor unencrypted EAP success messages. This allows the attacker to know when authentication can succeed. Then the attacker can also use VLAN replay through switch spoofing, where the attacker mimics the response from the RADIUS server to spoof the Tunnel Private Group Id attribute to manipulate the VLAN using a fake switch through an interment-diary device. After the attacker steals the session through authentication, the attacker can clone the MAC address of the legitimate device, disconnect the network connection with the original device, and connect a fake machine to the same switch port. The switch port that has been authenticated in the appropriate VLAN allows the attacker to access the protected VLAN by fully bypassing NAC control.

1.4.14 Session Tracking
	Modern NAC has an active device authentication process that tracks the session status of devices connected to the network. Enforcement NAC session tracking helps NAC make real-time access decisions in detecting and managing the reauthentication process. The need for enforcement session tracking in the NAC system arises because the NAC system cannot differentiate between a reconnection and an at-tack, so session tracking helps NAC monitor authenticated device sessions such as IP address, MAC address, timestamp, switch port, and device posture assessment. The session tracking widely used by NAC is Cisco pxGrid, which functions to enable integration between the NAC server, firewall, SIEM, and endpoint detectors. The NAC session tracking policy is that every device connected to the network has a session ID, which is then used as a security tool to validate the identity and session status of the device. 
	Devices that are successfully authenticated through 802.1X will have a session ID issued by the NAC server. The downside is that if an attacker hijacks the session ID, they can impersonate the session without re-authenticating, allowing them to access information through APIs, messages, and lateral movement of deviceses. If the attacker bypasses NAC's security controls, they can masquerade as a legitimate and authenticated device. Additionally, attackers can exploit session tracking policies through [API pxGrid] and [Replay Tactics], where they use mutual TLS and strong authentication to request session data by sending fake updates. Attackers also use device cloning by copying session-related information directly associated with the NAC, such as MAC addresses, hostnames, and tokens.

1.4.15 Certificate Pinning
	System Certificate Pinning NAC functions to lock the storage location of certificates and verify the certificates used by users to access the network. NAC serves to filter users who use certificates to avoid attackers using duplicate unauthorized certificates to access the network. The NAC system ensures that only ap-proved devices can access the internal network. The certificate is installed by an endpoint management tool that has linked the certificate to the identity of the legitimate device. The endpoint management links authentication with the certificate in the trusted platform module to minimize the risk of certificate forgery.
	NAC has implemented certificate pinning, namely TPM Bound and certificates in the OS store. TPM uses strong protection to ensure that the certificate cannot be exploited. Although TPM can still be exploited through TPM firmware vulnerabilities using a weak TPM emulator. NAC uses a fallback mechanism to accommodate older devices without TPM support. NAC allows devices to use OS store certificates or MAC address authentication if authentication against TPM fails. However, the downgrade and fallback scenarios can be exploited by attackers by masquerading as old devices without TPM to bypass NAC control policies. TPM was created to prevent the extraction of certificate keys, but if TPM is vulnerable, the certificate can be accessed by attackers masquerading as devices using EAP-TLS authentication with tools [Rubeus, Certipy, and certreq.exe] to gain unauthorized access.

1.4.16 RADIUS CoA / Enforcement
	NAC uses RADIUS Change of Authorization (CoA) to manage devices after the authentication process. CoA responds to the NAC server through switch commands related to the device attempting to access the network. This causes NAC to make decisions to quarantine devices that fail to connect due to failed device health checks or decide to grant access after the device has been updated. CoA allows NAC to change device access if needed, CoA makes NAC responsive when the status and behavior of endpoints fluctuate. The NAC policy in using CoA is that devices logging in with EAP-TLS are placed in a public VLAN, and if the agent reports that the logged-in device is healthy, the NAC sends a CoA to apply a DACL to grant access to the server. If the device fails posture, the NAC will issue a CoA to isolate the device.
	CoA can be bypassed by red teaming if an attacker can spoof CoA by sending commands to the server to revoke access from legitimate devices or move them to a quarantine VLAN. Attackers can also spoof the DACL through CoA to gain access to the network. Then the attacker can use the strategy of [Fake CoA Injection] to inject CoA messages into the network. An attacker who knows the IP address and shared secret of the NAC RADIUS can send malicious CoA packets to the switch. Fake CoA Injection can be performed using tools like [RadEapTest] to clone CoA, allowing the attacker to revoke and grant access to any device on the network. In addition to CoA injection, attackers can perform [control path hijacking] by hijacking the communication between NAC and the switch through ARP spoofing on the RADIUS server IP to launch a MITM attack. Once the attacker successfully hijacks the CoA message with NAC, the NAC enforcement becomes ineffective, allowing the attacker to change the access rights of their devices, isolate legitimate users, and disconnect legitimate devices.

1.4.16 Trust Re-Validation
	In modern NAC systems, re-validation is not done just once because trust re-validation is a re-authentication process for devices that are already connected to the network. This is done to ensure that the connected devices still comply with the security policies set by NAC. Revalidation is very important because without revalidation, devices that pass the initial check and successfully connect to the network will remain connected indefinitely. Therefore, to ensure that only trusted and healthy devices can access the network, they must be placed in a secure VLAN.
	The implementation of re-validation in the real world on the NAC system is carried out by sending an EAP - Request Identity frame for posture checking to the endpoint, so the device must respond using valid credentials. If the device fails to respond, the NAC moves the device to a quarantine VLAN, blocks the port, and terminates the connection session. Revalidation is very important for network security, but even though revalidation is quite effective, attackers can still exploit revalidation as an opportunity by observing the revalidation process carried out by the de-vice. Attackers can build an auto responder by faking legitimate responses and acting faster before the NAC notices the anomalies and re-authenticates the device. 
	The red team can bypass Trust Re-Validation using [an auto responder with MAC or valid certificates]. Attackers can create a program that automatically responds to the NAC's re-authentication process using forged credentials. An attacker who clones the MAC address and uses a legitimate device certificate can use that data for revalidation, allowing the attacker to deceive the NAC. Additionally, attackers can also use [ESP32 or Implant for Persistence] Attackers can maintain access to the network using ESP32 microcontroller hardware that can mimic the MAC address and perform re-authentication automatically using logic scripts. ESP32 can be hidden in LAN ports, electrical sockets, and device casings to provide access to the attacker.

1.5 NAC Eclipse Architecture
1.5.1 Passive Reconnaissance
	Passive reconnaissance is the basic phase in the NAC-Eclipse framework where the red team observes the network without any active interaction. The goal of passive reconnaissance is to gather as much information as possible about the target network, such as authentication protocols, VLAN segmentation, endpoint behaviour, and the NAC policies used by the network. The use of passive reconnaissance techniques allows attackers to gain a clear and important understanding of how the NAC system works in classifying devices that request access to the network. At the passive reconnaissance stage, the information needed by the attacker includes VLANs (pre-auth, quarantine, and production). Additionally, NAC systems like Cisco ISE/Aruba ClearPass become one of the key elements for the red team in making subsequent bypass decisions. Passive Reconnaissance is important to adjust the strategy that will be used to bypass NAC to minimize detection and increase the chances of successfully bypassing NAC.
	The passive reconnaissance phase has 4 stages in gathering information, such as identifying EAP methods through EAPOL Sniffing, VLAN detection (Pre-auth, Quarantine, and Production Network), LLDP, CDP, and DHCP Option fingerprinting, and finally, identifying NAC vendors (Cisco ISE, Aruba ClearPass).
a. Identify EAP method via EAPOL sniffing
The attacker begins by monitoring EAPOL traffic because devices attempting to connect to a network protected by NAC must go through the authentication process using EAP. The passive sniffing step is carried out solely to determine the type of EAP used by NAC. Whether the network uses EAP-TLS, EAP-PEAP, or EAP-MD5, information regarding EAP usage is crucial for the attacker because each type of EAP has a different approach, requiring the attacker to adjust their attack strategy according to the EAP used by NAC.
b. Detect VLANs (pre-auth, quarantine, prod)
	After identifying the EAP method via EAPOL sniffing, the next step taken by the attacker is to identify the VLANs used by the NAC system. The implementation of VLANs by the NAC serves as an access control mechanism where devices that want to connect to the network but are not yet authenticated and do not meet the requirements to access the network will be placed in a pre-auth VLAN or quarantine VLAN.
	In analysing VLANs, the attacker needs to analyse DHCP responses, network behaviour, and routing rules used when devices connect to the network passively. With this information, the attacker can conclude the type of VLAN used by the NAC and how to gain access to the production VLAN.
c. Fingerprint LLDP, CDP, DHCP options
	The attacker needs to conduct a protocol fingerprinting session to listen to broadcast and multicast messages on the network using LLDP and CDP protocols, which are used by switches and devices to inform their presence. Attackers using passive reconnaissance techniques can obtain important information such as switch port IDs, endpoints, and clues about the network topology that are crucial for bypassing NAC.
	In addition to using the LDDP and CDP protocols, attackers also use DHCP options (vendor class identifier, parameter request list) to obtain information about the endpoint configuration system. The data is used to accurately compile a profile to identify the type of device considered "compliant" by NAC.
d. Identify NAC vendor (ISE, ClearPass)
	An important phase of passive reconnaissance is vendor fingerprinting, which can determine how the NAC system operates on the target network. This can be observed from DHCP response patterns, URL redirects, and certificates in 802.1X traffic.
Attackers also need to identify the vendor (Cisco Identity Engine (ISE), Aruba ClearPass, and FortiNAC) used by the NAC because each system has different configuration systems, APIs, and enforcement mechanisms.
1.5.2 Active Reconnaissance dan Cloning Phase
	After passive reconnaissance, the attacker will perform active reconciliation and cloning, where this phase is very important in the NAC-Eclipse architecture because the attacker shifts from passive reconnaissance to active reconnaissance that directly interacts with the network. Active reconnaissance aims to mimic the identity of legitimate and authenticated devices within the system. This step allows the attacker to understand how to bypass the profiling mechanism on NAC, which relies on device behaviour, network metadata, and device fingerprints. There are 4 steps in conducting active reconnaissance: cloning the MAC address, spoofing DHCP Options, emulating LLDP/CDP system capabilities, and matching the operating system fingerprint (OS fingerprint).
a. MAC Address Cloning
	Each device has a unique MAC address, and the NAC system uses the MAC address to identify devices that want to connect to the network as one of the main parameters in the MAC profiling process. An attacker who can obtain the MAC address from a trusted device through the mirror technique on a switch port can clone the MAC address to be exactly the same as the original MAC address. Cloning the MAC address can allow the attacker to inherit the victim's network access rights.
b. DHCP Option Spoofing
	NAC checks the DHCP options when a device attempts to connect to the network. Information such as hostname, vendor class identifier, and parameter request list (PRL) are used by NAC to determine the type of device attempting to connect to the network. In the NAC bypass stage, the attacker designs a DHCP packet that resembles a legitimate device authenticated by the NAC. The attacker can use tools like [DHCP client] or [scapy] to manipulate the NAC so that it classifies the attacker's device as a legitimate device.
c. Emulation of LLDP/CDP System Capabilities
	Modern switches and NAC agents use the LLDP/CDP protocol to collect information related to endpoints such as the software used by the endpoint, the type of device, and the capabilities of the device. Therefore, attackers can perform fake LLDP/CDP cloning to send messages so that the NAC can be manipulated into believing that the fake device is the same as the device present in the system. 
d. Operating System Fingerprint Matching The attacker aligns the operating system fingerprint to resemble the fingerprint of legitimate devices, such as TCP/IP stack, port status, and timing characteristics, which can be profiled by users using tools like [nmap, p0f]. These tools identify the attributes used by NAC in posture-based enforcement mode. After the attacker clones all the necessary device identities such as MAC, DHCP, LLDP

1.5.3 Identity Hijack Phase

Identity Hijack is one of the crucial techniques in the NAC-Eclipse architecture that attackers use to switch from passive reconciliation activities to active exploitation. The main objective of identity hijack is to obtain the legitimate user's identity within the network. By knowing the identity of legitimate devices on the network, attackers can use the already authorized identity to bypass authentication mechanisms and gain access to the network protected by NAC.



Fig. 20: NAC Eclipse Architecture

The main strategy used in the identity hijack phase is the theft of certificates in PEM (Privacy Enhanced Mail) or PFX (Personal Information Exchange) format. The certificate is used as an identity in the EAP-TLS protocol to bypass NAC authentication. To extract PEM and PFX certificates, the tools used by attackers are [Mimikatz], especially if the credentials and certificates are stored in the local certificate store. Mimikatz functions to retrieve authentication such as private keys if there is protection on the credential guard. Additionally, [certipy and se-cretsdump.py] can also be used to extract secret certificates remotely using Active Directory Certificate Services.
After the certificate is successfully obtained by the attacker, the certificate can be used for communication with the network. Another tool that can be used is [wpa_supplicant] to handle network authentication that supports EAP-TLS. The attacker uses the cloned certificate to mimic the original device and complete the 802.1X authentication as the legitimate device does. Additionally, attackers can also use EAP Relay attacks with the [eap-relay.oy.] tool to access certificates using a man-in-the-middle proxy tactic that can capture and forward EAP messages from legitimate devices to the NAC infrastructure. EAP relay does not require permanent certificate theft, but attackers can temporarily exploit active sessions when the export of legitimate certificates is blocked, yet hijacking by the attacker can still be carried out.
1.5.3 Auth Bypass Phase
One of the important stages in the NAC Eclipse architecture is the auth by-pass because this stage directly targets the authentication layer as the main gateway of NAC. In the auth bypass stage, attackers not only impersonate legitimate devices and steal data but also gain unauthorized direct access to the network by manipulating the authentication protocol that verifies user identities. The main targets of the attackers in this Auth Bypass are EAP-TLS and EAP-PEAP/MSCHAPv2. In EAP-TLS, attackers can exploit trust through certificate injections. EAP-TLS, which uses manual certificate-based authentication, can be exploited if the attacker can obtain valid certificates and private keys during the identity hijack phase. After obtaining the certificate, the attacker can inject the stolen certificate into the authentication process to masquerade as a trusted device.

In EAP-PEAP, where the credential authentication process is encapsulated within a TLS tunnel. The attacker can perform a challenge-response exchange and crack the NTLM hash using tools like [hashcat]. The attacker can also carry out a relay attack directly using [responder]. In a relay attack, the attacker does not need the original device's password because the attacker can act as an intermediary to forward the credentials in real-time to the server.
1.5.4 Posture & Compliance Bypass
The NAC system conducts posture assessment and compliance checks as an additional security measure to verify that a device complies with the company's security policies before granting network access. The checks include the use of anti-virus, operating system version, patch level, and encryption status. Then, the posture and compliance bypass phase is carried out by the attacker to circumvent the NAC mechanism by convincing that unauthorized devices have complied with the standards to join the network. There are four stages that the attacker performs in the posture & compliance bypass, namely Spoof NAC Agent response via curl/Python, Forge health check JSON ("antivirus":"healthy"), Capture real token (replay in head-less browser or API), Clone captive portal (auto-submit fake scan).
a. Spoof NAC Agent response via curl/Python
	NAC that relies on agents (Sisco AnyConnect, ForeScout, Aruba OnGuard) installed by endpoints to report the health of their devices before switching to the NAC server. The agent communicates using HTTP/HTTPS in JSON/XML format. In the posture & compliance bypass method, attackers can use HTTP clients like [curl] or the [requests] library in Python. Attackers who reverse engineer legitimate agent traffic can craft and send fake responses indicating that the device is healthy and compliant with NAC policies. This can allow the attacker to bypass the device health check and avoid the quarantine VLAN and limited access VLAN.
b. Forge health check JSON
	The NAC system uses a structured data format like JavaScript Object Notation to obtain information related to device health.  Therefore, attackers can modify JSON objects by spoofing the attributes required by NAC. If NAC does not validate the modified devices, unauthorized devices can be accepted, allowing the JSON spoofing tactic to successfully deceive the compliance engine and gain full access to the production network.
c. Capture real token
NAC that uses posture validation with a single sign-on (SSO) system with tokens (SAML, OIDC, OAuth2). Devices that successfully pass the compliance check can use session tokens to maintain access. Therefore, attackers can capture legitimate tokens through session hijacking, phishing, and browser exploitation. Once they obtain a legitimate token, it can be directly inserted into API requests or replayed using a headless browser. A headless browser allows attackers to mimic user behavior to automate the login process or form filling. This approach can also allow attackers to bypass posture validation and user interaction by reloading the trust that has been obtained by legitimate devices.
d. Clone captive portal
NAC that relies on captive portals to collect device posture data before granting full access. However, web-based captive portals are not secure because the portal can trust any data sent by the device if the portal assumes that the data comes from legitimate users and devices. In captive portal cloning, attackers can create a replica of the HTML structure and behavior of the original captive portal. By using an automated script, the attacker can automatically send a captive portal cloning scan to bypass the check. However, if the backend server does not verify the authenticity of the scanning data, the attacker will succeed in bypassing the posture check.
1.5.5 Persistence & Covert Re-entry
Persistence & Covert Re-entry
	An attacker who has successfully bypassed the NAC authentication and pro-filing process, the next step needed is persistence to maintain the attacker's access over a long period without being detected by NAC. Persistence & Covert re-entry is useful for maintaining the existence of the attacker's device within the network even during NAC re-authentication, administrative audits, and network reconfiguration. There are three techniques used by attackers to achieve persistence and covert re-entry, namely [ESP32 or Raspberry Pi Dropbox auto-reauthing, dynamic MAC/cert rotate with time window, use NAC APIs (ISE pxGrid or CPPM API) to inject attack-er as compliant device.
- ESP32 or Raspberry Pi dropbox auto-reauthing
	One of the tactics in maintaining hidden persistence within a network is to place a physical dropbox device within the target network perimeter. The ESP32 microcontroller/Raspberry Pi device is the primary choice because of its small size, low cost, and ability to run a lightweight Linux-based authentication client [wpa_supplicant]. After configuring using a fake certificate, the attacker automatically re-authenticates to the network controlled by NAC. The attacker uses Power over Ethernet, which can be placed anywhere, under the table, in the network cabinet, and behind the printer. The presence of a small USB that allows long-term access.
- Dynamic MAC/cert rotate with time window
	Modern NAC that keeps sessions active by tracking endpoint attributes such as MAC addresses and user certificates. Additionally, the NAC system also detects device behavior anomalies. Therefore, to avoid detection by NAC, the attacker implements a rotation mechanism that changes the MAC address and certificate ac-cording to a schedule determined by NAC. That tactic creates identity entropy, making the attacker's device appear as several legitimate endpoints over time, tracking endpoint attributes by NAC. As long as the endpoint identities used by the attacker alternately fall within the NAC trust profile, the attacker can maintain hidden access without appearing to violate NAC policies.
- Use NAC APIs (ISE pxGrid or CPPM API)
	 To inject attacker as compliant device APIs are essentially used for device registration, posture management, and enforcement of NAC policy compliance. If APIs are not monitored properly, they can potentially be exploited as vectors to insert attacker-controlled devices into the NAC trusted list. By using forged administrative tokens, attackers can obtain the API to register foreign endpoints with qualifying posture attributes, allowing these foreign devices to gain access without going through traditional authentication processes, whether human-controlled or automatically controlled by the NAC system.
1.5.6 Exploit Add-ons
	Exploit Add-ons within the NAC-Eclipse framework are designed as an optional and opportunistic layer that exploits vulnerabilities found by the NAC infrastructure. Exploit Add-ons differ from spoofing, relay, and impersonation techniques; the Exploit Add-ons phase targets systematic weaknesses and configuration errors in NAC technology to gain unauthorized access to the network, privilege escalation, and direct takeover of the NAC server. Exploit Add-ons have several techniques such as NAC misconfig exploit, NAC portal unauth RCE, and API injection.
- NAC misconfig exploit 
	Change of Authorization (CoA) is used by NAC to move devices between VLANs after the posture validation process is successful. Improperly configured CoA handling allows attackers to send false CoA requests to network access devices (switches). This causes the port to switch to a different VLAN to avoid isolation. VLAN ACLs are used to restrict access between VLANs. Therefore, errors in ACL configuration can undermine the role of NAC, allowing for lateral movement to bypass the designed network segmentation.
- NAC portal unauth RCE
	In the open-source-based NAC system, a captive portal is provided for guest registration, remediation, and posture compliance. If the portal has vulnerabilities against web applications, then remote code execution (RCE) without authentication can be directly exploited by attackers to take over the NAC server. RCE without authentication allows attackers to execute the server arbitrarily by sending malicious HTTP requests into the portal. If attackers succeed in controlling the NAC backend through RCE exploitation, they can send CoA requests to whitelist malicious devices, disable security policies, and fully access logs and credentials, thereby undermining the trust model established by NAC in the network.
- API injection 
Cisco ISE and Aruba ClearPass provide RESTful APIs to integrate with other networks and security systems. The API functions for device registration, creating authentication policies. If the API is exposed externally, attackers can inject malicious requests to bypass NAC authentication. API injection can bypass token validation, exploit API endpoints, and hijack session tokens. Attackers can send API requests to register fake devices as compliant devices to bypass posture checks. At-tackers can also modify NAC configuration rules through the API and then take over administrative control.
5.4 Experimental Setup
NAC red teaming simulation was conducted in virtual lab environment using virtual box for server & endpoint configuration and deployment where as GNS3 were used for network and port security configuration and deployment. Below are the list of opensource resources or tools used in virtual lab:
1. Virtual Box: this were used to simulate create virtual space with multiple endpoints like window 10, ubuntu, windows server 2022, packetfence server and kali.
a. Windows 10, it was used as legitimate device configured with group/NAC policy
b. Ubuntu 22.4, it was used as legitimate device too, configured with NAC policy
c. Windows server 2022 used for certain case to act like radius server for authentication and for domain based network for resources management and enforce group policy
d. Packetfence 14.1.0, it was used for dedicated network access control to enforce certificate based authentication 802.1x & MAB support.
e. Kali, it was used to understand the weakness of NAC technology and bypass for the NAC enabled network to get unauthorized network access.
2. GNS3: virtual network setup were done using switch simulation CISCO IOSv-L2 images with port security, dynamic VLAN assignment and 802.1X support
3. Endpoints: set of different windows & Linux based vm used for legitimate client and attacker machine.
a. Legitimate client: windows 10 pro vm, & ubuntu 22.4 with 802.1x supplicant con-figured for EAP-TLS authentication.
b. Attacker machine: kali Linux and parrot vm were set up with two bridged interface for MAC spoofing, packet inspection and attack to get initial access to NAC enabled network.
4. Bridge setup: GNS3 hub, iplink, iptables, ebtables, tc for ethernet port splitter to mirror the traffic and connection of endpoints attacker and legitimate machine on same switch port using hub and iplink.
5. Tools: Wireshark, T-shark, tcpdump, Ettercap, Responder, Nmap, scapy and mac-changer.
Simulated Bypass Scenarios Tested on Virtual Lab Environment:
NAC Bypass ID	Technique	Description 
NB1	MAC Spoofing	MAC cloning of authorised device and configuring spoofed MAC into Attacker host
NB2	Profile Evasion 	Emulate OS fingerprinting like windows, IP phone, android, Linux, etc using DHCP/LLDP spoofing
NB3	VLAN Hopping 	VLAN injection using crafted packets like double tagging and DHCP spoofing
NB4	CoA Injection	De-authenticate the legitimate client and take over the session using CoA (Change of authorization).
NB5	MAB device emulation	Mimicking the MAC address of network devices, IoT like printer, VoIP phone to bypass profiling.
NB6	Rouge DHCP	Attacker DHCP server used to bypass the NAC for legitimate client
NB1	Inline session hijack	Attacker machine stays connected via bridge, hijacks the session after client shutdown even for certificate base 802.1x EAP-TLS authentication.

Evaluation Metrics:
Sr. No.	Metrics	Description
1	Time to Bypass (TTB)	Mean time taken to gain network access post connection
2	Time to Detect (TTD)	Time NAC/Switch takes to trigger alert
3	Persistent window (PW)	Reauth time window where attacker machine remains active before detected by NAC
4	Reauth Trigger rate (RTR)	Frequency of forced reauthentication events
5	Initial network access success rate (INASR)	% of successful network access 

1.6 Results and Analysis:
NB5 - Inline Session Hijack
NAC red teaming sample of 1 attempts were made using Inline Session Hijacking provided a success rate of over 85%, almost every time it gives access by bypassing the network access control even for 802.1x EAP-TLS certificate authentication. Frequent & periodic re-authentication mechanism downtime the access to network, together with profiling and Unique set of identifier whitelisting might reduce success rate to less than 1% as reauth takes place every 10seconds. However, it may slow down the network performance and increase the congestion. The connection persists until link down detection occur or reauth occur. One attempt failed during testing due to legitimate windows 10 system were not shut down or disconnected, observed that attacker can get success access to network by using the active session of legitimate devices on same port.

NB4 - CoA Injection
While 2 out of 4 testing attempts were performed in misconfigured environment where ACL restriction was not enabled on CoA, observed that both successfully providing access to network to attacker device by hijacking the session while de-auth the legitimate system. Enabling ACL on CoA restricted access for another both attacks.
NB1 - MAC Spoofing: 
Testing use case created using IP-MAC binding or MAC filtering based on white-listing where 2 legitimate system MAC ID was spoofed and configured the cloned MAC to attacker machine i.e. kali machine one by one at a time, observed that 100% network access was guaranteed within 16 seconds and remained active beyond 1 hours. Profiling makes harder to get access which NB2 with OS detection however fingerprinting using net discover and responder tools and using same OS ubuntu help to bypass basic profiling security in NAC system. Even in a secure system if fallback MAB is enabled it will bypass the NAC to get internet access. The detection observed is 0% unless profiling is enforced.

Statistical Overview of Results
Technique	INASR (%)Avg	TTB Avg	PW	TTD
NB1/5	100	16s	>3600s	>3600s
NB2	50	30s	1200s	>1200s
NB4	50	20s	600s	>600s
NB6	85	9s	>300s	>300s
NB1	15	10s	>3600s	>3600s














Comparative Analysis
NAC Bypass ID	Technique	Auth.
Requires	Detection
difficulty	Can be
automated	INASR
NB1/5	MAC Spoofing	No	Low	Yes	100%
NB2	Profile Evasion 	No	Medium	Yes	50%
NB3	VLAN Hopping 	Partial	Medium	Yes	NA
NB4	CoA Injection	Yes	Medium	Partial Yes	50%
NB6	MAB emulation	No	Medium	Yes	15%
NB1	Inline session hijack	No	High	Yes	85%

 Conclusion
The red teaming framework is designed to evaluate the security of the Network Access Control system. Red teaming exploits the weaknesses of Network Access Control through reconnaissance, identity theft, authentication subversion, posture evasion, exploitation module resilience, and simulating the behavior of legitimate devices to bypass the NAC security system. As a result of the research and experiments conducted by the researchers, it was shown that the NAC vulnerability allows attackers to use MAC spoofing techniques, clone legitimate device profiles, and perform inline session hijacking to bypass NAC policies. 802.1X authentication, where the success rate of inline hijacking exploitation reaches over 85% on switch port sessions and MAC spoofing, enables unauthorized access to bypass NAC policies. Attackers can commit identity theft through certificate theft (PEM/PFX), EAP relay, and API exploitation to manipulate the NAC system to gain access to the network. The attacker bypasses posture checks and compliance with NAC policies using JSON payloads and SSO token replay to bypass device validation on the NAC backend. Then, to maintain long-term access, the attacker can use an ESP32 / Rasp-berry Pi to maintain a hidden presence in the network.
In this study, a comparative analysis is presented where the detection rate of attackers appears low unless NAC frequently checks for device behavior and reauthentication of devices and users connected to the network. However, even though NAC performs profile checks and reauthentication, the limited NAC CoA policy and poorly segmented VLANs allow attackers to move laterally within the network and escalate privileges by using cloned profiles of legitimate devices and cloned MAC addresses from devices that have already gained access to the production VLAN. 
In conclusion, this research shows that the implementation of NAC for network security is still relatively weak because attackers can exploit NAC using various methods such as MAC spoofing, MAC IP Binding, Device profiling, user certificate, device certificate, compliance, captive portals, dynamic VLAN assignment, session tracking, certificate pinning, RADIUS Coa, and Trust re-validation. Therefore, NAC needs to conduct a strong check on the profiles of users accessing the network, continuous posture validation, and adaptively analyze the behavior of devices and users for effective network monitoring. This research and testing out-come offers a comprehensive breakdown of all sort of NAC bypass techniques together with their effectiveness under various configuration. It shows that NAC alone is not enough to secure the network access control to attacker even with certificates if identity and session persistence are not actively monitored and frequent re-authentication is not enabled. This research gives a automated logic and framework that help to identify the risks associated with NAC system. It help red teamer and security engineer to understand the gaps in network control system and reconfigure to make robust network security.
